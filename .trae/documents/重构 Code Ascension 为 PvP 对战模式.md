# 重构计划：互联网创业对战版 (Code Ascension PvP)

我将完全重写游戏逻辑，将其从 PvE 爬塔改为 PvP (玩家 vs AI) 回合制对战游戏。

## 1. 核心架构重构
*   **状态机 (StateMachine)**：引入更复杂的回合阶段：
    *   `TURN_START` (回合开始，判定控制效果)
    *   `DRAW_PHASE` (摸牌阶段，摸3张)
    *   `ACTION_PHASE` (出牌阶段，自由出牌)
    *   `RESPONSE_PHASE` (响应阶段，如询问是否出闪)
    *   `DYING_PHASE` (濒死阶段，求桃/世界和平)
    *   `TURN_END` (回合结束，弃牌等)
*   **玩家对象 (Player/AI)**：
    *   统一血量上限为 5。
    *   属性：`hp`, `hand`, `equipments` (装备区), `satchel` (锦囊区), `buffs` (狂暴/控制状态)。
    *   AI 增加 `aiDelay` 模拟思考时间。

## 2. 卡牌全量实现与映射
我将所有需求卡牌映射为“互联网/编程”主题：

| 原始需求 | 新名称 | 类型 | 效果 |
| :--- | :--- | :--- | :--- |
| **基础牌** | | | |
| 伤害牌 (杀) | **`上线发版`** | 基础 | 造成1点伤害 (每回合限1次，除非有CI/CD)。 |
| 闪避牌 (闪) | **`代码回滚`** | 基础 | 抵消一次伤害。 |
| 回血牌 (桃) | **`获得融资`** | 基础 | 回复1点HP。 |
| **装备牌** | | | |
| 连弩 (无限杀) | **`CI/CD流水线`** | 装备 | 可以无限出杀。 |
| 50%概率闪避 | **`负载均衡`** | 装备 | 被伤害时50%概率自动闪避。 |
| 强命 (无法闪避) | **`强制推送`** | 装备 | 造成的伤害无法被闪避。 |
| 66%免疫伤害 | **`防火墙`** | 装备 | 66%概率免疫伤害，否则+1伤。 |
| 狂暴模式 | **`996福报`** | 装备 | 造成伤害+1，受到伤害+1。 |
| 反伤甲 (33%反弹) | **`反弹Shell`** | 装备 | 33%概率反弹全额伤害。 |
| **锦囊/技能牌** | | | |
| 偷窃 (顺手牵羊) | **`挖墙脚`** | 锦囊 | 拿走对方一张牌。 |
| 拆牌 (过河拆桥) | **`DDOS攻击`** | 锦囊 | 弃置对方一张牌 (50%再弃一张)。 |
| 乐不思蜀 (禁出牌) | **`服务器宕机`** | 延时 | 判定阶段50%概率跳过出牌阶段。 |
| 兵粮寸断 (禁摸牌) | **`资金冻结`** | 延时 | 判定阶段50%概率跳过摸牌阶段。 |
| 酒 (伤害+1) | **`打鸡血`** | 锦囊 | 本回合下一张杀伤害+1。 |
| 破釜沉舟 (各-1血) | **`恶性竞争`** | 锦囊 | 双方各扣1点血。 |
| 桃园结义 (各+1血) | **`行业峰会`** | 锦囊 | 双方各回1点血。 |
| 虚弱 (下回合禁杀) | **`空城计`** | 锦囊 | 下回合对方无法使用普通伤害牌。 |
| 禁疗 (100%禁回血) | **`断供`** | 锦囊 | 下回合对方无法回血。 |
| 决斗 (拼杀/弃装备) | **`技术辩论`** | 锦囊 | 对方需展示杀/闪，否则弃置所有装备。 |
| 借刀杀人 (拼点伤) | **`借刀杀人`** | 锦囊 | 对方展示一张牌，若我有同名牌则打出造成2点无法闪避伤害。 |
| 大洗牌 | **`重构项目`** | 锦囊 | 弃光手牌，摸等量牌。 |
| 重摸 | **`热更新`** | 锦囊 | 弃置此牌，摸一张牌。 |
| 抢劫 | **`专利流氓`** | 锦囊 | 对方交出杀，否则扣1血。 |
| 锦囊槽位 | **`备用方案`** | 特殊 | 可存一张牌，免疫拆偷。 |

## 3. 特殊机制实现
*   **合并伤害 (Merge Request)**: 玩家选中两张“上线发版”时，UI 显示“合并”按钮，打出造成必中伤害。
*   **世界和平 (World Peace)**: 濒死阶段若有“杀+闪”，显示“世界和平”按钮，强制回1血并结束回合。
*   **AI 逻辑**: 
    *   完全可见玩家手牌数量（背面）。
    *   贪心算法：能出牌就出，优先出装备，优先搞玩家心态（控制/拆迁）。
    *   濒死时自动求生。

## 4. 界面优化
*   增加 **`GameLog`** 面板，记录每一条操作（“AI 对你使用了 DDOS 攻击...”）。
*   增加 **`ResponseModal`**，当 AI 攻击玩家时，弹窗询问“是否使用代码回滚？”。
*   更新布局：AI 在上（显示手牌背面），玩家在下。中间是战场区。

待确认后，我将直接生成包含所有逻辑的 `game_bundle.js`。
